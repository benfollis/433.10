o# Driver class for Mercury Remote Control Outlets
# Codes are currently base on the 350.115UK sockets
# See https://www.amazon.co.uk/Mercury-350-115-Remote-Control-Adaptor-Black/dp/B0051NIJA4

class Mercury:

    SOCKET_CODES = {
        1 : { 'on' : '00000001000011100100001110010000100001000011100100001000010000111001000011100100001110010000100001110011100100001000011100111001',
              'off' : '00000001000011100100001110010000100001000011100100001000010000111001000011100100001110010000100001110011100111001110010000100001' },
        2 : { 'on' : '00000001000011100100001110010000100001000011100100001000010000111001000011100100001110011100111001000010000100001000011100111001',
              'off' : '00000001000011100100001110010000100001000011100100001000010000111001000011100100001110011100111001000010000111001110010000100001' },
        3 : { 'on' : '00000001000011100100001110010000100001000011100100001000010000111001000011100111001110010000100001000010000100001000011100111001',
              'off' : '00000001000011100100001110010000100001000011100100001000010000111001000011100111001110010000100001000010000111001110010000100001' },
        4 : { 'on' : '00000001000011100100001110010000100001000011100100001000010000111001110011100100001110010000100001000010000100001000011100111001',
              'off' : '00000001000011100100001110010000100001000011100100001000010000111001110011100100001110010000100001000010000111001110010000100001' },
        5 : { 'on' : '00000001000011100100001110010000100001000011100100001000011100111001000011100100001110010000100001000010000100001000011100111001',
              'off' : '00000001000011100100001110010000100001000011100100001000011100111001000011100100001110010000100001000010000111001110010000100001' }
    }

    SYMBOL_DURATION = 0.0001
    TRANSMIT_ATTEMPTS = 10 # a sensible default
                           
    def __init__(self, bit_driver):
        self.bit_driver = bit_driver

    def switch_socket(self, socket_id, state):
        code = self.SOCKET_CODES[int(socket_id)][state]
        for bit in code:
            self.bit_driver.send_bit(int(bit), self.SYMBOL_DURATION)
            
    
        
    
        
    
