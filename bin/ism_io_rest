#!/usr/bin/env python
# basic server to test the web server stuff, to be deleted
import os
import SimpleHTTPServer
import SocketServer
from optparse import OptionParser
import ism_io.config
import ism_io.web

if __name__ == '__main__': # which it will:
    #load oour command line flags
    parser = OptionParser()
    parser.add_option("-c", "--config", dest="config", help="Config FILE to load", metavar="FILE")
    (options, args) = parser.parse_args();
    # parse the config file locaiton as relative to here
    config_path = os.path.join(os.getcwd(), options.config)
    config_binder = ism_io.config.ConfigBinder(config_path)
    config = config_binder.bind()
    
    handler = ism_io.web.RestServer
    handler.sockets = config["sockets"]
    port = config["rest"]["port"]
    server = SocketServer.TCPServer(('', port), handler)
    print "Starting up server on port " + str(port)
    server.serve_forever()
    
